{% load wagtailcore_tags wagtailimages_tags wagtailembeds_tags %}

<div class="paragraph-with-map-block">
    <div class="map" style="height: 300px; width: 400px;"></div>

    {{ value.content }}

    <script type="text/javascript">
        var mapElement = document.currentScript.parentNode.querySelector('div.map');
        var locations = [ {% for location in value.locations %} ["{{ location.name }}", {{ location.point.x }},
            {{ location.point.y }}], {% endfor %}];

        MapWidget.renderMap(mapElement, locations);
    </script>
</div>