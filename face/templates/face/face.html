{% extends "base.html" %}
{% load i18n wagtailimages_tags %}
{% load face_filters %}

{% block feed_block %}
<link rel="alternate" type="application/rss+xml" title="RSS" href="{% url "face_feeds" %}">
<link rel="alternate" type="application/atom+xml" title="Atom" href="{% url "face_feeds" %}">
{% endblock %}

{% block meta_title %}{% trans "Faces" %}{% endblock %}
{% block title %}{% trans "Faces" %}{% endblock %}

{% block opengraph_block %}
{% if slug %}
<meta property="og:title" content="{{ face.title }}">
<meta property="og:url" content="http{% if request.is_secure %}s{% endif %}://{{ site.domain }}{{ face.get_absolute_url }}">
<meta property="og:image" content="http{% if request.is_secure %}s{% endif %}://{{ site.domain }}{% if face.featured_image %}{{ face.featured_image.file.url }}{% else %}{{ STATIC_URL }}img/default_featured_image.png{% endif %}">
<meta property="og:type" content="article">
<meta property="og:published_time" content="{% firstof face.original_published_date|date:"c" face.first_published_at|date:"c" %}">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@{{ SOCIAL_TWITTER }}">
<meta name="twitter:title" content="{{ face.title }}" >
<meta name="twitter:description" content="View the face on {{ SITE_TITLE }}" >
<meta name="twitter:image" content="http{% if request.is_secure %}s{% endif %}://{{ site.domain }}{% if face.featured_image %}{{ face.featured_image.file.url }}{% else %}{{ STATIC_URL }}img/default_featured_image.png{% endif %}" >
<meta name="twitter:url" content="http{% if request.is_secure %}s{% endif %}://{{ site.domain }}{{ face.get_absolute_url }}" >
{% endif %}
{% endblock %}

{% block extra_js %}
    <script type="text/javascript" src="{{ STATIC_URL }}album/js/magnific-popup.js"></script>
    <script type="text/javascript" src="{{ STATIC_URL }}face/js/lightbox.js"></script>
{% endblock %}

{% block extra_uncompressed_js %}
{% if slug %}
    <script type="text/javascript">
      $(function() {
	  $('a[data-slug="{{ slug }}"]').click();
      });
    </script>
{% endif %}
{% endblock %}

{% block extra_css %}
    <link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}album/css/magnific-popup.css">
    <link type="text/less" rel="stylesheet" href="{{ STATIC_URL }}css/v2/pages/faces/faces.less">
{#    <link type="text/less" rel="stylesheet" href="{{ STATIC_URL }}css/v2/layout/components/main-content/story-grid.less">#}
{% endblock %}


{% block breadcrumb_menu %}
    <li class="active">{% trans "Faces" %}</li>
{% endblock %}

{% block main %}
  <div class="container content-container">

    <div class="gallery-title">
    <div class="row">
        <div class="col-lg-3 col-md-3 col-sm-4 col-xs-12 gallery-title-icon go-back-faces">
            <span class="prev">
                <a class="link-light" itemprop="url" href="{% url "face-list" %}">
                    <i class="fa fa-angle-left"></i>
                    <span itemprop="name">{% trans "FACES DIRECTORY" %}</span>
                </a>
            </span>
        </div>
        <div class="col-lg-6 col-md-6 col-sm-4 col-xs-12">
            {% include "includes/page_content_header/heading.html" %}
        </div>
        <div class="col-lg-3 col-md-3 col-sm-4 col-xs-12 gallery-title-icon face-upload-share">
            <span class="face-upload">
                <a class="link-light" href="{% url "static_page" slug="contribute-to-faces" %}">
                    <i class="fa fa-upload" aria-hidden="true"></i>
                    <span class="link-text" itemprop="name">{% trans "Upload face" %}</span>
                </a>
            </span>
            {% with request.build_absolute_uri as url %}
                <span class="gallery-social-icon">
                    <a href="https://twitter.com/home?status={{ title|urlencode }}+{{ url|urlencode }}" target="_blank" class="link-light">
                        <i class="fa fa-twitter" aria-hidden="true"></i>
                    </a>
                    <a href="https://facebook.com/sharer.php?u={{ url|urlencode }}&t={{ title|urlencode }}" target="_blank" class="link-light">
                        <i class="fa fa-facebook" aria-hidden="true"></i>
                    </a>
                </span>
            {% endwith %}
        </div>
    </div>
    </div>

    <div class="row filter-lang">
        <span  class="filter-label">Faces of <b>district names</b> starting with</span>
        <span class="filter-value">
            <select class="select-no-style pull-left" name="lang" onchange="location =this.value">
                {% for letter in "abcdefghijklmnopqrstuvwxyz" %}
                  <option class="banner-language-list" {% ifequal alphabet letter %}selected='selected'{% endifequal %} value="{% url "face-detail" alphabet=letter %}" >
                    <a class="distric-alphabet">{{ letter|capfirst }}</a>
                  </option>
                {% endfor %}
            </select>
            <i class="fa fa-angle-down" aria-hidden="true"></i>
        </span>
    </div>

    <ul>
      <div class="popup-gallery story-grid" data-url="{% url "face-detail" alphabet=alphabet %}">
      {% for face in faces %}
        <li class="tile">{% image face.image fill-514x514 as face_image %}
          <a href="{{ face.get_absolute_url }}"
             data-face-details="

                    {% if face.title  %}
                        <h4 class='face-name'>{{face.title }}</h4>
                    {% endif %}

                    {% if face.age  %}
                        <div class='face-detail face-age'><div class='face-label'>AGE</div><div class='face-value'>{{ face.age }}</div></div>
                    {% endif %}

                  {% if face.occupation  %}
                        <div class='face-detail face-occupation'><div class='face-label'>OCCUPATION</div><div class='face-value'>{{ face.occupation }}</div></div>
                  {% endif %}

                  {% if face.occupation_of_parent  %}
                        <div class='face-detail'><div class='face-label'>PARENTS' OCCUPATION</div><div class='face-value'>{{ face.occupation_of_parent }}</div></div>
                  {% endif %}

                  {% if face.adivasi  %}
                        <div class='face-detail'><div class='face-label'>ADIVASI</div><div class='face-value'>{{ face.adivasi }}</div></div>
                  {% endif %}

                  {% if face.location.name  %}
                        <div class='face-detail face-village-name'><div class='face-label'>VILLAGE</div><div class='face-value'>{{ face.location.name }}</div></div>
                  {% endif %}

                  {% if face.location.panchayat  %}
                        <div class='face-detail'><div class='face-label'>PANCHAYAT</div><div class='face-value'>{{ face.location.panchayat }}</div></div>
                  {% endif %}

                  {% if face.location.sub_district_name  and face.location.sub_district_type %}
                        <div class='face-detail'><div class='face-label'>{{ face.location.sub_district_type|upper }}</div><div class='face-value'>{{ face.location.sub_district_name }}</div></div>
                  {% endif %}

                  {% if face.location.district  %}
                        <div class='face-detail'><div class='face-label'>DISTRICT</div><div class='face-value'>{{ face.location.district }}</div></div>
                  {% endif %}

                  {% if face.location.state  %}
                        <div class='face-detail'><div class='face-label'>STATE</div><div class='face-value'>{{ face.location.state }}</div></div>
                  {% endif %}

                   {% if face.image.photographers %}
                        <div class='face-detail'>
                            <div class='face-label'>PHOTOGRAPHER</div>
                            <div class='face-value'>
                                <span>{{ face.image.photographers.all|join:", "}}<span>
                                {% if face.image.camera %}
                                    <span>• {{ face.image.camera }}<span>
                                {%endif%}
                                {% if face.image.date %}
                                    <span>• {{ face.image.date|date:'M d, Y' }}<span>
                                {%endif%}
                            </div>
                        </div>
                  {% endif %}

                  {% if face.location not in face.image.locations.all and face.image.locations.all%}
                        <div class='face-detail'>
                        <div class='face-label'>PHOTO TAKEN IN</div>
                        <div class='face-value'>
                            {{ face.image.locations.all|join:". "}}
                        </div></div>
                  {% endif %}

                  {% if face.quote  %}
                        <div class='face-detail'><div class='face-label'>QUOTE</div><div class='face-value'>{{ face.quote }}</div></div>
                  {% endif %}

                    {% if face.additional_info  %}
                        <div class='face-detail'><div class='face-label'>ADDITIONAL INFORMATION</div><div class='face-value'>{{ face.additional_info }}</div></div>
                  {% endif %}
"


             data-slug="{{ face.slug }}" class="image-tag mfp-image" data-url="{{ face.get_absolute_url }}">
            <img class="img-responsive grid-image no-border" src="{{ face_image.url }}" alt="{{ face|alt_text }}">
          </a>
            <div class="caption">
                <div class="name">{{face.title|capfirst }}</div>
                <div class="district">{{ face.location.district|capfirst }}</div>
            </div>
        </li>
    {% empty %}
      <div class="error-message-holder">
	    <p class="text-center text-danger">Sorry! There are no faces on this page. Please consider <a href="{% url "static_page" slug="contribute-to-faces" %}">contributing</a> one.</p>
      </div>
    {% endfor %}
    </div>
    </ul>
  </div>
{% endblock %}
